<scene>
	<!-- Independent sample generator, user-selected samples per pixel -->
	<sampler type="independent">
		<integer name="sampleCount" value="128"/>
	</sampler>

	<integrator type="vol_path" />

	<!-- Render the scene as viewed by a perspective camera -->
	<camera type="perspective">
		<transform name="toWorld">
			<lookat target="0,0,0" origin="0,10,1" up="0,0,1"/>
		</transform>

		<float name="fov" value="70"/>
		<float name="focalLength" value="11"/>
    	<float name="lensRadius" value="0.01"/>

		<boolean name="distortion" value="true"/>
		<float name="K1" value = "0.3"/>
		<float name="K2" value = "0.3"/>

		<integer name="width" value="1920"/>
		<integer name="height" value="1080"/>
	</camera>

	<!-- Earth -->
	<mesh type="sphere">
		<point name="center" value="22  -10 -50" />
        <float name="radius" value="45"/>

        <bsdf type="diffuse">
            <texture type="image_texture" name="albedo">
                <string name="filename" value="/textures/earth8k.png"/>
				<vector name="scale" value="1, 1"/>
				<vector name="shift" value="0.5 0"/>
            </texture>
        </bsdf>
	</mesh>
	<!-- Moon -->
	<mesh type="sphere">
		<point name="center" value="10 -100 -30" />
        <float name="radius" value="20"/>

        <bsdf type="diffuse">
            <texture type="image_texture" name="albedo">
                <string name="filename" value="/textures/moon8k.png"/>
				<vector name="scale" value="0.5, 0.5"/>
            </texture>
        </bsdf>
	</mesh>

	<!-- Asteroid field -->
	<mesh type="obj">
		<string name="filename" value="/models/asteroids.obj"/>
			<bsdf type="diffuse">
            <texture type="image_texture" name="albedo">
                <string name="filename" value="/textures/meteorite.png"/>
            </texture>
        </bsdf>

		<transform name="toWorld">
			<scale value="0.2 0.2 0.2"/>
			<rotate axis="1,0,0" angle="90"/>
			<translate value="-10,-40,-2"/>
			
		</transform>
	</mesh>

	<!-- Locomotive -->
	<mesh type="obj">

		<string name="filename" value="/models/locomotive.obj"/>
		<bsdf type="diffuse">
	
			
			<texture type="image_texture" name="albedo">
                <string name="filename" value="/textures/locomotive_diffuse_mirrored.png"/>
            </texture>
		</bsdf>

		<transform name="toWorld">
			<rotate axis="1,0,0" angle="90"/>
			<rotate axis="0,0,1" angle="105"/>
			<translate value="0,-6,-2.5"/>
		</transform>
	</mesh>

	<!-- Background -->
	<mesh type="obj">
		<string name="filename" value="/models/plane.obj"/>

		<!--<bsdf type="diffuse">
            <texture type="image_texture" name="albedo">
                <string name="filename" value="/textures/starmap.png"/>
				<vector name="scale" value="30, 30"/>
            </texture>
        </bsdf>-->

		<emitter type="area">
			<texture type="image_texture" name="albedo">
                <string name="filename" value="/textures/starmap.png"/>
				<vector name="scale" value="5, 5"/>
            </texture>
		</emitter>

		<transform name="toWorld">
			<scale value="1000 1000 1000"/>
			<translate value="0,-1000,0"/>
		</transform>
	</mesh>


	<!-- Volumes -->
	<!-- Locomotive Smoke 
	<medium type="heterogeneous">
        <phase type="isotropic"/>
        <color name="sigma_a" value="0.8,0.8,0.8"/>
        <color name="sigma_s" value="2,2,2"/>

		 TODO (gimoro): maybe find a better smoke volume 
		<integer name="density_type" value="2"/>
		<string name="volume_grid" value="/volume_grids/locomotive-smoke.nvdb"/>

		 TODO (gimoro): fix position 
        <vector name="center" value="-0.8 0 3.4"/>
        <vector name="size" value="2 2 2"/>

		<transform name="toWorld">
			<rotate axis="1,0,0" angle="-10"/>
			<rotate axis="0,0,1" angle="-90"/>
		</transform>
    </medium> -->

	<!-- Earth Clouds/Atomsphere -->
	<medium type="heterogeneous">
        <phase type="isotropic"/>
        <color name="sigma_a" value="0.01, 0.05, 0.01"/>
        <color name="sigma_s" value="0.0001,0.009,0.025"/>

		<integer name="density_type" value="4"/>
		<float name="exp_b" value="5"/>

        <vector name="center" value="22  -10 -50"/>
        <float name="min_radius" value="45"/>
        <float name="max_radius" value="48"/>
    </medium>


	<!-- Lights -->
	<emitter type="point">
		<point name="position" value="0,-60,-30"/>
		<color name="power" value="8000,8000,8000"/>
	</emitter>

	<emitter type="point">
		<point name="position" value="10,10,0"/>
		<color name="power" value="10000,10000,10000"/>
	</emitter>

	<emitter type="point">
		<point name="position" value="0,10,0"/>
		<color name="power" value="10000,10000,10000"/>
	</emitter>

	<emitter type="point">
		<point name="position" value="-10,10,0"/>
		<color name="power" value="1000,1000,1000"/>
	</emitter>

<!-- Sunlight from Right to Left-->
	<emitter type="directional">
		<vector name="direction" value="-1.0,0.1,0"/>
		<color name="power" value="2.44,2.33,1.55"/>
	</emitter>

</scene>
